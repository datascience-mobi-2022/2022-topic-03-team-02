---
output:
  pdf_document: default
  word_document: default

fontsize: 11pt
#geometry: left = 1.5cm, right = 1.5cm, top = 1.5cm, bottom = 2cm
geometry: margin = 2cm
linestretch: 1.5

bibliography: references.bib
csl: citationstyle.csl

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\pagenumbering{gobble}

\

\
\
\Huge \textbf{Data Analysis Project 2022} \newline Report
\
\
\large Institute of Pharmacy and Molecular Biotechnology

\
Topic 03: Proteome-wide Screen for RNA-dependent Proteins \newline Sub-project 2: HeLa Cells Synchronized in Mitosis \newline\
Supervisor: Dr. Maïwen Caudron-Herger \newline Tutor: Niklas Engel

Students: Michel Tarnow, Michèle Bennek, Lennart Müller, Sebastian Rickert \newline Date: 20.07.2022

\newpage
\tableofcontents
\addtocontents{toc}{~\hfill\textbf{Page}\par}


```{=tex}
\newpage
\pagenumbering{arabic}
```
# **1. Introduction**

RNA-binding proteins (RBPs) are a group of proteins who share the characteristic of directly binding to RNA molecules [@gebauer2021rna]. Thus formed complexes are termed ribonucleoprotein particles (RNPs), prominent examples of which include the spliceosom [@corley2020rna], the signal recognition particle [@faoro2021noncanonical] and the RNA-induced silencing complex [@pratt2009rna]. RBPs play key regulatory functions in the life cycle of RNA molecules, including transcription, splicing, modification, intracellular trafficking, translation and degradation [@gebauer2021rna].

RBPs are known to bear discrete domains that are responsible for the molecular interactions between amino acid residues and RNA nucleotides that lead to RNA binding, and which for this reason are defined as RNA-binding domains (RBDs), such as the RNA recognition motif, the K-homology domain or DEAD/DEAH helicase and zinc-finger domains [@corley2020rna]. Although the occurrence of one or more of these domains is characteristic of RBPs, more recent research has identified RBPs that lack known RBDs but instead bind RNA through intrinsically disordered regions [@gebauer2021rna], indicating the heterogeneity of this group of proteins.

Since RBPs are key players in RNA metabolism, their malfunction has been associated with diverse pathological phenotypes, including cancer [@zhang2020comprehensive] and neurodegenerative disorders [@maziuk2017dysregulation]. Therefore, identifying new RBPs may contribute to point out novel drug targets for already known conditions on the one hand and to shed new light on the diseased mechanisms of yet unresolved conditions on the other.

While the study and quantification of RBPs has received much attention in previous research, the exact number of mammalian RBPs remains a matter of debate. Techniques for proteome-wide screening of RBPs in the past heavily relied on pull-down assays of polyadenylated RBPs [@beckmann2016expanding; @castello2016comprehensive], protease digestion [@mullari2017specifying] or UV cross-linking [@urdaneta2019purification], each method having its advantages and shortcomings. Thus, current estimations about the number of RBPs remain largely inconsistent across studies, leading only to a small consensus set of around 200 proteins [@caudron2019r].

While not devoid of its own limitations, the here presented method provides a novel approach to the proteome-wide screening of RBPs with the goal of validating the core set of RBPs previously defined while also contributing to adding new proteins to the number of possible RBP candidates.\
For this purpose, the notion of RNA dependence was introduced, defining a protein as RNA dependent when its interactome depends on RNA, while binding to RNA is sufficient but not necessary to qualify as RNA dependent. Thus, every RNA binding protein is RNA dependent, but not every RNA dependent protein is RNA binding [@caudron2019r].

The method here employed relies on the differential migration pattern of proteins in a sucrose density gradient after ultracentrifugation in the presence or absence of RNA.\
In density gradient centrifugation, macromolecules such as proteins are forced through a density gradient until they find a density equal to their own (Farrell, 2010). Thereby the rate of sedimentation is function of size, shape and density of the macromolecules, as well as density and viscosity of the gradient and applied centrifugal force (Raschke et al., 2009).\
Here, triplicates of native (control) and RNase-treated cell lysates from HeLa cells synchronized in mitosis were loaded onto a 5% to 50% sucrose density gradient. Upon ultracentrifugation, the gradient was divided into 25 fractions and the protein amount of individual proteins per fraction determined by quantitative mass spectrometry. Because RNA-dependent proteins directly or indirectly depend on the presence of RNA, they are expected to show a different migration pattern between control and RNase-treated groups [@caudron2019r].

In this report, we seek to draw a qualified conclusion about the RNA-dependence status of the 7160 proteins investigated in the provided data set using bioinformatics and statistics. For this purpose, we will define criteria and parameters the given proteins need to fulfill to qualify as RNA-dependent, and will evaluate our given data with respect to aforementioned aspects using the programming language R. Eventually, we will discuss the significance and possible limitations of our methods and findings.

\newpage

# **2. Methods**

## **2.1 Preliminary Steps**

Before interpreting our data with respect to RNA dependent proteins, we performed a set of preliminary steps to ensure the validity and conclusiveness of our approach.

For the purpose of cleaning our data, we first tested whether every column's data type was numeric, which was the case for all 150 columns. Subsequently, we removed all proteins that contained negative protein amounts or only zeros in at least one of the three replicates for each condition (control and RNase), which was the case for a total of 7 proteins. Although replacement strategies do exist, we decided against keeping these proteins in our data set because these anomalies were not compatible with our further analysis steps and indicated an error in measurement.

In theory - all other things being equal - replicating the same experiment three times should produce three times the same result. This is equivalent to saying that, for a given fraction, the sum of protein amount values across all included proteins of the data set should be equal for all three replicates. However, this is not the case because in reality, experimental conditions aren't ideal and are subject to various sources of distortion, including naturally occurring statistical fluctuations and limited measurement accuracy. Thus, in order to ensure comparability of our data, it was necessary to perform a column-wise normalization step. For this purpose, we computed the sums of protein amount values for each replicate of a given fraction across all 7152 proteins still included in our data set. Subsequently, we computed the mean of the two closest sums, i. e. the two sums with the smallest absolute difference to each other. Using this mean value, we defined a normalization factor for each replicate of each fraction by dividing the sum of a given replicate by aforementioned mean value. This produced a vector of three normalization factors for each fraction. Last, protein amount values of a given replicate were multiplied with their corresponding normalization factor, resulting in a column-wise normalization in that for a given fraction, the sum of protein amount values across all included proteins of the data set was now equal for all three replicates.

Furthermore, since all proteins investigated in our data set naturally show a heterogeneous expression level in living cells, it was necessary to perform an additional row-wise normalization step to ensure comparability between different proteins. For this purpose, we set the protein amount to be 100 for each replicate in each condition. After this step, the sum of the protein amount across all 25 fractions was equal to 100 for each replicate. In other words, normalizing our data changed the absolute protein levels for each fraction while the protein amount in each fraction relative to the total protein amount across all fractions stayed the same.

Next, we wanted to evaluate the reproducibility of our data. For this purpose, we computed the correlation (Pearson) between replicates within each condition in all possible combinations (for example, correlation between control replicate 1 and 2, 1 and 3 and 2 and 3). This allowed us to sort out single proteins whose data did not seem to be reproducible. We defined a threshold correlation value below which the data for given proteins was regarded as non-reproducible. For this purpose, we looked at the number of proteins we would have to discard for each threshold level between 0 and 0.8 in 0.05 steps:

```{r echo=FALSE, cache=FALSE}

plot(seq(0, 0.8, 0.05), readRDS("tres_values.rds"), type = "b", xlab = "threshold value", ylab = "number of removed proteins", main = "")

abline(v = 0.6, col = "red", lwd = 1, lty = 2)
```

Considering this, we identified a threshold level of 0.6 as a good compromise between choosing a preferably high threshold level on the one hand and avoiding to remove too many proteins from our data set on the other. This led to the removal of another 25 proteins from our data set. Therefore, we removed a total of 32 proteins from our data set, which amounts to around 0.5% of all proteins from our native data set.

Last, for each protein and condition, all three replicates were combined into a single vector of protein amount values using the mean value between replicates for each fraction.

## **2.2 Identification of RNA-dependent proteins**

As mentioned earlier, RNA-dependent proteins are expected to show an altered migration pattern in a sucrose density gradient after ultracentrifugation in the presence or absence of RNA. After performing aforementioned preliminary steps, we set to identify possible RNA-dependent proteins by interpreting this altered migration pattern, that is the distribution of normalized protein amount values across all 25 fractions for both conditions, control and RNase. For this it was necessary to define selection criteria proteins have to fulfill in order to qualify as RNA-dependent. Here, proteins are considered RNA-dependent when (i) the position of the global maximum of the protein amount across all 25 fractions shows an absolute shift between control and RNase of 1 fraction or greater, and (ii) there is a significant difference in protein amount between the position of the global maxima in control and the protein amount at the respective fractions in RNase. This meant that first, we had to identify the global maximum for each protein in control and RNase condition, so that subsequently we could test for shift in position of the global maximum and significance of difference in protein amount.

For the purpose of determining the shift in position of the global maximum, we used aforementioned vectors that combine all three replicates of a given condition using the mean value method. Global maxima for all proteins were then identified by determining the greatest value of protein amount across all 25 fractions for a given protein. This resulted in two values, the averaged position of the global maximum in control and the averaged position of the global maximum in RNase, which were used to calculate the absolute and real magnitude of the shift.

Significance of difference in protein amount was tested using a Student's t-test. Here, for every given protein, we first determined the global maximum for each replicate in control, yielding a vector containing the magnitude and the respective fraction of each maximum. Subsequently, protein amount values at the respective fractions in RNase were determined, yielding a second vector containing protein amount values at the respective fractions. We then tested whether protein amount values from the first vector significantly differed from those of the second vector and thus tested significance of difference in protein amount for each protein in our data set, leading to a total of 7127 t-tests performed. P-values were corrected for multiple testing by controlling the false-discovery rate (FDR) according to @benjamini1995controlling, using the function `p.adjust`. Therefore, difference in protein amount was regarded as significant if the FDR-corrected p-value $p$ was smaller than the chosen significance level of $\alpha=0.05$. 

## **2.3 Performing Dimension Reduction Analysis**
In this step of our analysis, we looked at a data set that, for a given protein, combine all three replicates of a given condition using the mean value method, meaning that each protein can be characterized by fifty values - 25 mean protein amount values from control and 25 mean protein amount values from RNase.Thus, each protein from our data set can be depicted as a point in a fifty-dimensional space. Here, in order to identify directions in the data corresponding to biological effects, we sought to transform our data from this high-dimensional space into a lower-dimensional space with fewer relevant variables while retaining as much variance in our data as possible. For this purpose, we performed principal component analysis (PCA) on our data set using the built-in function `prcomp`, followed by Uniform Manifold Approximation and Projection (UMAP) analysis using the function `umap`. 
Subsequently, we colored proteins according to their shifting behavior, once with respect to whether or not they show a shift at all and once furhter differentiating between left shifting, right shifting and not shifting proteins. Left shifting proteins were defined as proteins whose maximum shifted towards smaller fractions between control and RNase condition as determined in part 2.2, i. e. proteins whose real shift in position of the global maximum was negative. Similarly, right shifting proteins showed a shift in position of the global maximum towards higher fractions, and not shifting proteins a real shift of zero.

## **2.4 Developing a Linear Regression Model**
Last, for all proteins included in our data set, we sought to develop a linear regression model that features variables from our previous analysis steps. Here, we tried to predict the absolute and real shift in position of the global maximum using the correlation between the mean protein amount values between control and RNase for each given protein. This approach is based on the rationale that proteins with low correlation between control and RNase are expected to show distinct alterations in the distribution of protein amount values across all 25 fractions between both conditions, which in turn may increase the chance for a protein to show a shifting behavior by our definitions as stated above.
For that purpose, we randomly split our data set so that 80% of all proteins included served to train our model while the remaining 20% were used to test it. We used the built-in function `lm` to do the training and `lm.predict` for the purpose of testing.

- absoluter versus realer shift durch korrelation zwischen kombinierten 
- residuals etc. bewiesen 


- precision recall 

\newpage

## **2.5 Validating Our Results**

\newpage

# **3. Results**

## **3.1 RNA-dependent proteins**
According to aforementioned methods and criteria, we computed the RNA-dependence status for all 7127 still included in our data set and identified a total of 657 as RNA-dependent, which amounts to around 9.2% of all proteins tested.


- Precision, recall 

## **3.2 Performing Dimension Reduction Analysis**

```{r, echo=FALSE, out.width="49%", fig.align = "center", fig.show='hold', fig.cap="Test"}
knitr::include_graphics(
  c("C:/Users/lenna/OneDrive/Dokumente/2022-topic-03-team-02/report/images/UMAP.png",
    "C:/Users/lenna/OneDrive/Dokumente/2022-topic-03-team-02/report/images/UMAP.png")
)
```
- Result: Es bilden sich zusammengehlrige Gruppen! 


- "Tröpfchenplot"
- Plot: no shift/shift und left/right/no nebeneinander!

- kmeans auf shift gemacht und wenn PLatz einfügen
\newpage

# **4. Discussion**

-   T-Test mit nur 2 Replikaten möglich, aber Mehraufwand für 7 Proteine nicht zumutbar, deshalb einfach entfernt + Mittelwert als Replacement

-   \<0.6 in mind. einem Vergleich o allen 3en??

-   Abbildung, um column-wise normalization zu erklären??
\newpage

# **5. References**


