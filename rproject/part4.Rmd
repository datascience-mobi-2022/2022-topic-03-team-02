---
title: "Analysis Part 4"
author: "Mich√®le, Michel, Lennart, Sebastian"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache = TRUE)
library("tidyverse")
library("uwot")
```

## Michel's Part

```{r}
df_normalized <- readRDS("RDeeP_HeLa_Mitosis_normalized.rds")
```

```{r}
pca <- prcomp(df_normalized)
df_umap1 <- as.data.frame(umap(pca$x))
df_umap2 <- as.data.frame(umap(df_normalized))
```

```{r}
ggplot(df_umap1, aes(x = V1, y = V2)) +
  geom_point()

ggplot(df_umap2, aes(x = V1, y = V2)) +
  geom_point()
```

```{r}
n = 1
df_umap <- cbind(df_umap1, matrix(0, nrow(df_normalized_combined), 1))
colnames(df_umap) <- c("V1", "V2", "shift")

for (i in 1:nrow(df_umap)) {
  if (shift_global[i] < -n) {
    df_umap[i, 3] <- "left shift"
  } else if (shift_global[i] > n) {
    df_umap[i, 3] <- "right shift"
  } else {
    df_umap[i, 3] <- "no shift"
  }
  
}
```



```{r}
ggplot(df_umap, aes(x = V1, y = V2, color = shift)) +
  geom_point()
```

```{r}
x <- grep("left", df_umap$shift)
y <- grep("right", df_umap$shift)
z <- c(x, y)

df_umap_shift <- df_umap[z, ]
df_umap_no_shift <- df_umap[-z, ]

ggplot(df_umap_shift, aes(x = V1, y = V2, color = shift)) +
  geom_point()
ggplot(df_umap_no_shift, aes(x = V1, y = V2, color = shift)) +
  geom_point()
```
## Michel 2

```{r}
df_global_maxima <- readRDS("RDeeP_HeLa_Mitosis_global_maxima.rds")
```

```{r}
n = 1
df_global_maxima_shift <- cbind(df_global_maxima, matrix(0, nrow(df_normalized_combined), 1))
colnames(df_global_maxima_shift)[5] <- "shift"

for (i in 1:nrow(df_global_maxima_shift)) {
  if (shift_global[i] < -n) {
    df_global_maxima_shift[i, 5] <- "left shift"
  } else if (shift_global[i] > n) {
    df_global_maxima_shift[i, 5] <- "right shift"
  } else {
    df_global_maxima_shift[i, 5] <- "no shift"
  }
  
}
```

```{r}
ggplot(
  df_global_maxima_shift,
  aes(y = ctrl_global_maximum_fraction, x = rnase_global_maximum_fraction, color = shift)
) +
  geom_count()
```

```{r}
ggplot(
  df_global_maxima_shift,
  aes(y = ctrl_global_maximum_fraction, x = rnase_global_maximum_fraction, color = shift)
) +
  geom_jitter()
```



